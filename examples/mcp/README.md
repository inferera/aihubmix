# @aihubmix/mcp 测试示例

这个目录包含了 `@aihubmix/mcp` 包的测试示例，用于验证 MCP 服务器的功能。

## 功能特性

- ✅ MCP 命令测试
- ✅ MCP 服务器启动测试
- ✅ 文件操作测试
- ✅ API 工具测试
- ✅ 绘画工具测试

## 运行测试

### 前置条件

1. 确保已安装 Node.js (>= 18)
2. 确保已安装 pnpm
3. 在项目根目录运行 `pnpm install`

### 运行测试

```bash
# 在 examples 目录下运行
pnpm test:mcp

# 或者直接运行
tsx mcp/index.ts
```

### 环境变量

测试需要以下环境变量（可选）：

```bash
export AIHUBMIX_API_KEY="your-api-key-here"
```

## 测试内容

### 1. MCP 命令测试
- 验证 `@aihubmix/mcp` 包是否正确安装
- 检查命令是否可用
- 显示帮助信息

### 2. MCP 服务器测试
- 启动 MCP 服务器
- 验证服务器是否正常启动
- 安全停止服务器

### 3. 文件操作测试
- 创建测试文件
- 写入文件内容
- 读取文件内容
- 验证文件内容

### 4. API 工具测试
- 测试 HTTP 请求功能
- 验证网络连接

### 5. 绘画工具测试
- 模拟绘画工具测试
- 验证工具接口

## 测试输出示例

```
🚀 开始执行 @aihubmix/mcp 测试套件

📁 设置测试目录...
✅ 测试目录设置完成

📋 执行 MCP 命令测试...
✅ MCP 命令可用
📖 帮助信息预览:
Usage: aihubmix-mcp [options]

🔧 执行 MCP 服务器测试...
✅ MCP 服务器启动成功

📄 执行 文件操作测试...
✅ 文件写入成功
✅ 文件读取成功

🌐 执行 API 工具测试...
✅ HTTP 请求测试成功

🎨 执行 绘画工具测试...
✅ 绘画工具测试通过（模拟）

📊 测试结果汇总:
==================================================
✅ MCP 命令测试 (1234ms)
✅ MCP 服务器测试 (3456ms)
✅ 文件操作测试 (567ms)
✅ API 工具测试 (890ms)
✅ 绘画工具测试 (123ms)
==================================================
总计: 5 个测试
通过: 5 个
失败: 0 个

🎉 所有测试通过！

🧹 清理测试环境...
✅ 清理完成
```

## 故障排除

### 常见问题

1. **MCP 命令不可用**
   - 确保已正确安装 `@aihubmix/mcp` 包
   - 检查 Node.js 版本是否 >= 18

2. **服务器启动失败**
   - 检查 API 密钥是否正确设置
   - 确保网络连接正常

3. **文件操作失败**
   - 检查文件权限
   - 确保测试目录可写

### 调试模式

可以通过设置环境变量启用详细日志：

```bash
export DEBUG=aihubmix:mcp
tsx mcp/index.ts
```

## 相关链接

- [@aihubmix/mcp 包文档](../../packages/mcp/README.md)
- [MCP 协议文档](https://modelcontextprotocol.io/)
- [AIHubMix 官网](https://aihubmix.com/) 
